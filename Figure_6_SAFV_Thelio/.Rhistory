setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
#Finding Nodes
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Visualize the rooted tree with bootstrap values as text labels
q <- ggtree(ml_tree, ladderize = TRUE) +
geom_nodepoint(aes(subset = !is.na(as.numeric(label)) & as.numeric(label) > 90),
size = 15.5, shape = 18, color = "black") +
geom_treescale(x=0, y=55, color='black', fontsize = 40, linesize = 3) +
geom_tiplab(aes(subset = node %in% c(75), label = label), size = 15, align = TRUE, offset = 0.08, fontface = 'bold', color = "black") +  # Bold node 7
geom_tiplab(aes(subset = !node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, color = "white")  # Regular for others
q
# Load metadata
metadata <- read.csv('polyprotein_md.csv', header = TRUE)
unique(metadata$Country)
unique(metadata$Date)
unique(metadata$Species)
unique(metadata$Virus_Name)
unique(metadata$Accession)
# Define colors for continent
mycolor <- c("Cardiovirus theileri" = "#AC3EC1", "Cardiovirus ranori" = "#920000", "Cardiovirus saffoldi" = "#477BD1", "Cardiovirus dhusarah" = "#46B298", "Cardiovirus rueckerti" = "#DE478E", "Cardiovirus rudhira" = "#00BB00", "Study Isolate" = "gold", "Unclassified"= "#FF8E32")
# Plot with metadata
p <- q %<+% metadata +
geom_tippoint(aes(color = Species), size = 20.0) +
scale_color_manual(values = mycolor) +
theme(legend.position = 'left',
legend.text = element_text(size = 80),  # Adjust text size
legend.title = element_text(size = 80)) + # Adjust title size
coord_cartesian(xlim = c(0, max(nodeHeights(ml_tree)) * 1.4))
# Add clade label (replace 135 with the actual node number you want to label)
#p <- p +
#geom_cladelabel(node = 135, label = "Cardiovirus saffoldi clade",
#  align = TRUE, offset = 0.1, barsize = 3,
# fontsize = 20, angle = 0, color = "black")
# Save the plot
ggsave("Cardiovirus_all_RRR_Polyprotein.pdf", width = 65, height = 75, units = "in", dpi = 600, limitsize = FALSE)
setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio_fixed.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
#Finding Nodes
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Visualize the rooted tree with bootstrap values as text labels
q <- ggtree(ml_tree, ladderize = TRUE) +
geom_nodepoint(aes(subset = !is.na(as.numeric(label)) & as.numeric(label) > 90),
size = 15.5, shape = 18, color = "black") +
geom_treescale(x=0, y=55, color='black', fontsize = 40, linesize = 3) +
geom_tiplab(aes(subset = node %in% c(75), label = label), size = 15, align = TRUE, offset = 0.08, fontface = 'bold', color = "black") +  # Bold node 7
geom_tiplab(aes(subset = !node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, color = "white")  # Regular for others
q
# Load metadata
metadata <- read.csv('polyprotein_md.csv', header = TRUE)
unique(metadata$Country)
unique(metadata$Date)
unique(metadata$Species)
unique(metadata$Virus_Name)
unique(metadata$Accession)
# Define colors for continent
mycolor <- c("Cardiovirus theileri" = "#AC3EC1", "Cardiovirus ranori" = "#920000", "Cardiovirus saffoldi" = "#477BD1", "Cardiovirus dhusarah" = "#46B298", "Cardiovirus rueckerti" = "#DE478E", "Cardiovirus rudhira" = "#00BB00", "Study Isolate" = "gold", "Unclassified"= "#FF8E32")
# Plot with metadata
p <- q %<+% metadata +
geom_tippoint(aes(color = Species), size = 20.0) +
scale_color_manual(values = mycolor) +
theme(legend.position = 'left',
legend.text = element_text(size = 80),  # Adjust text size
legend.title = element_text(size = 80)) + # Adjust title size
coord_cartesian(xlim = c(0, max(nodeHeights(ml_tree)) * 1.4))
# Add clade label (replace 135 with the actual node number you want to label)
#p <- p +
#geom_cladelabel(node = 135, label = "Cardiovirus saffoldi clade",
#  align = TRUE, offset = 0.1, barsize = 3,
# fontsize = 20, angle = 0, color = "black")
# Save the plot
ggsave("Cardiovirus_all_RRR_Polyprotein.pdf", width = 65, height = 75, units = "in", dpi = 600, limitsize = FALSE)
setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio_fixed.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
#Finding Nodes
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Visualize the rooted tree with bootstrap values as text labels
q <- ggtree(ml_tree, ladderize = TRUE) +
geom_nodepoint(aes(subset = !is.na(as.numeric(label)) & as.numeric(label) > 90),
size = 15.5, shape = 18, color = "black") +
geom_treescale(x=0, y=55, color='black', fontsize = 40, linesize = 3) +
geom_tiplab(aes(subset = node %in% c(75), label = label), size = 15, align = TRUE, offset = 0.08, fontface = 'bold', color = "black") +  # Bold node 7
geom_tiplab(aes(subset = !node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, color = "white")  # Regular for others
q
# Load metadata
metadata <- read.csv('polyprotein_md.csv', header = TRUE)
unique(metadata$Country)
unique(metadata$Date)
unique(metadata$Species)
unique(metadata$Virus_Name)
unique(metadata$Accession)
# Define colors for continent
mycolor <- c("Cardiovirus theileri" = "#AC3EC1", "Cardiovirus ranori" = "#920000", "Cardiovirus saffoldi" = "#477BD1", "Cardiovirus dhusarah" = "#46B298", "Cardiovirus rueckerti" = "#DE478E", "Cardiovirus rudhira" = "#00BB00", "Study Sample" = "gold", "Unclassified"= "#FF8E32")
# Plot with metadata
p <- q %<+% metadata +
geom_tippoint(aes(color = Species), size = 20.0) +
scale_color_manual(values = mycolor) +
theme(legend.position = 'left',
legend.text = element_text(size = 80),  # Adjust text size
legend.title = element_text(size = 80)) + # Adjust title size
coord_cartesian(xlim = c(0, max(nodeHeights(ml_tree)) * 1.4))
# Add clade label (replace 135 with the actual node number you want to label)
#p <- p +
#geom_cladelabel(node = 135, label = "Cardiovirus saffoldi clade",
#  align = TRUE, offset = 0.1, barsize = 3,
# fontsize = 20, angle = 0, color = "black")
# Save the plot
ggsave("Cardiovirus_all_RRR_Polyprotein.pdf", width = 65, height = 75, units = "in", dpi = 600, limitsize = FALSE)
setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio_fixed.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
#Finding Nodes
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Visualize the rooted tree with bootstrap values as text labels
q <- ggtree(ml_tree, ladderize = TRUE) +
geom_nodepoint(aes(subset = !is.na(as.numeric(label)) & as.numeric(label) > 90),
size = 15.5, shape = 18, color = "black") +
geom_treescale(x=0, y=55, color='black', fontsize = 40, linesize = 3) +
geom_tiplab(aes(subset = node %in% c(75), label = label), size = 15, align = TRUE, offset = 0.08, fontface = 'bold', color = "black") +  # Bold node 7
geom_tiplab(aes(subset = !node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, color = "black")  # Regular for others
q
# Load metadata
metadata <- read.csv('polyprotein_md.csv', header = TRUE)
unique(metadata$Country)
unique(metadata$Date)
unique(metadata$Species)
unique(metadata$Virus_Name)
unique(metadata$Accession)
# Define colors for continent
mycolor <- c("Cardiovirus theileri" = "#AC3EC1", "Cardiovirus ranori" = "#920000", "Cardiovirus saffoldi" = "#477BD1", "Cardiovirus dhusarah" = "#46B298", "Cardiovirus rueckerti" = "#DE478E", "Cardiovirus rudhira" = "#00BB00", "Study Sample" = "gold", "Unclassified"= "#FF8E32")
# Plot with metadata
p <- q %<+% metadata +
geom_tippoint(aes(color = Species), size = 20.0) +
scale_color_manual(values = mycolor) +
theme(legend.position = 'left',
legend.text = element_text(size = 80),  # Adjust text size
legend.title = element_text(size = 80)) + # Adjust title size
coord_cartesian(xlim = c(0, max(nodeHeights(ml_tree)) * 1.4))
# Add clade label (replace 135 with the actual node number you want to label)
#p <- p +
#geom_cladelabel(node = 135, label = "Cardiovirus saffoldi clade",
#  align = TRUE, offset = 0.1, barsize = 3,
# fontsize = 20, angle = 0, color = "black")
# Save the plot
ggsave("Cardiovirus_all_RRR_Polyprotein.pdf", width = 65, height = 75, units = "in", dpi = 600, limitsize = FALSE)
setwd("/Users/julia/Dropbox/MAVIAN_Lab/Manuscripts/Myanmar_September/Data_Scripts_Figures/Figure_6_SAFV_Thelio/")
library("ggtree")
library("phytools")
library("ggplot2")
library("ape")
# Load the tree
ml_tree <- read.tree("SAFV_Thelio_fixed.nwk")
#show node numberss
ggtree(ml_tree, ladderize = TRUE) +
geom_text(aes(label = node))
#Finding Nodes
which(ml_tree$tip.label == "Hlawaga-18|Myanmar|2018")
# Visualize the rooted tree with bootstrap values as text labels
q <- ggtree(ml_tree, ladderize = TRUE) +
geom_nodepoint(aes(subset = !is.na(as.numeric(label)) & as.numeric(label) > 90),
size = 15.5, shape = 18, color = "black") +
geom_treescale(x=0, y=55, color='black', fontsize = 40, linesize = 3) +
geom_tiplab(aes(subset = node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, fontface = 'bold', color = "black") +  # Bold node 7
geom_tiplab(aes(subset = !node %in% c(75), label = label), size = 12, align = TRUE, offset = 0.08, color = "black")  # Regular for others
q
# Load metadata
metadata <- read.csv('polyprotein_md.csv', header = TRUE)
unique(metadata$Country)
unique(metadata$Date)
unique(metadata$Species)
unique(metadata$Virus_Name)
unique(metadata$Accession)
# Define colors for continent
mycolor <- c("Cardiovirus theileri" = "#AC3EC1", "Cardiovirus ranori" = "#920000", "Cardiovirus saffoldi" = "#477BD1", "Cardiovirus dhusarah" = "#46B298", "Cardiovirus rueckerti" = "#DE478E", "Cardiovirus rudhira" = "#00BB00", "Study Sample" = "gold", "Unclassified"= "#FF8E32")
# Plot with metadata
p <- q %<+% metadata +
geom_tippoint(aes(color = Species), size = 20.0) +
scale_color_manual(values = mycolor) +
theme(legend.position = 'left',
legend.text = element_text(size = 80),  # Adjust text size
legend.title = element_text(size = 80)) + # Adjust title size
coord_cartesian(xlim = c(0, max(nodeHeights(ml_tree)) * 1.4))
# Add clade label (replace 135 with the actual node number you want to label)
#p <- p +
#geom_cladelabel(node = 135, label = "Cardiovirus saffoldi clade",
#  align = TRUE, offset = 0.1, barsize = 3,
# fontsize = 20, angle = 0, color = "black")
# Save the plot
ggsave("Cardiovirus_all_RRR_Polyprotein.pdf", width = 65, height = 75, units = "in", dpi = 600, limitsize = FALSE)
